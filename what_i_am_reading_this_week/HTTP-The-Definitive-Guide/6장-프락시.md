### 6.1 웹 중개자
- 프락시는 클라이언트와 서버를 매개하는 또 다른 HTTP 웹 서버다.
- 클라이언트 관점에서는 프락시가 서버다.
- 프락시는 클라이언트 요청에 대한 적절한 응답을 한다.
- 프락시는 클라이언트 요청을 적절히 처리하여 서버에 넘긴다.
- 프락시는 클라이언트, 서버 양 쪽과 통신하므로 양 쪽의 규칙을 모두 잘 따라야 한다.
- 프락시에는 개인 프락시, 공용 프락시가 있다. 
- 개인 프락시는 클라이언트에서 직접 실행되는 형태로 사용되며, 클라이언트 한 군데만을 위한 프락시를 말한다.
- 대부분의 프락시가 공용으로, 특히 캐시 프록시같은 경우 사용자가 많을 수록 공통된 요청을 처리하는 데 효율적이다.

**프락시 대 게이트웨이**
- 차이는 둘 이상의 같은 프로토콜을 사용하는 애플리케이션을 연결하느냐, 다른 프로토콜을 사용하는 애플리케이션을 연결하느냐다.
- 전자는 프락시, 후자는 게이트웨이
> 게이트웨이는 클라이언트와 서버가 서로 다른 프로토콜로 말하더라도 서로 간의 트랜잭션을 완료할 수 있도록 해주는 프로토콜 변환기처럼 동작한다.(p149)
- 하지만 완전히 구분되는 것은 아니다. 상용 프락시 서버는 SSL 보안 프로토콜, 방화벽, FTP 접근 등을 위해 게이트웨이 기능(프로토콜 변환)을 갖고 있다.

**언제 사용하는가**
- 성인 콘텐츠 차단
- 문서 접근 제어 : 중앙 프락시 서버가 권한별로 문서에 대한 접근을 제어할 수 있다.
- 보안 방화벽 : 조직 내외부에서 통신하는 응용 레벨 프로토콜의 흐름을 통제하거나, 트래픽을 검사하기 위한 훅을 제공하는 프락시 서버를 사용한다.
- 웹 캐시 : 멀리 있는 리소스 대신, 로컬에 리소스 사본을 저장해두는 프락시 서버 기능
- 대리 프락시 : 웹 서버처럼 보이지만, 리소스 위치를 찾기 위해 다른 서버와 통신한다. 
- 콘텐츠 라우터 : 트래픽과 콘텐츠 종류에 따라 특정 웹서버로 유도할 때 사용한다. 예) 비과금 고객이 콘텐츠를 요청하면 로컬 캐시로 전달, 과금 고객이면 원 서버로 전달
- 트랜스코더 : 응답 콘텐츠를 클라이언트에 전달하기 전에 변형시킨다. 확장자, 이미지 크기, 텍스트 압축, 기기에 맞게 조정된 웹 페이지, 국제화 등
- 익명화 프락시 : HTTP에서 신원을 식별하게끔 하는 값들을 제거하여 개인정보를 보호하는 장점, 하지만 사용자 브라우징 경험이 저하될 수도 있다.

> - User-Agent 헤더에서 사용자의 컴퓨터와 OS 종류를 제거한다.<br>
> - 사용자의 이메일 주소를 보호하기 위해 From 헤더는 제거된다.<br>
> - 어떤 사이트를 거쳐서 방문했는지 알기 어렵게 하기 위해 Referer 헤더는 제거된다.<br>
> - 프로필과 신원 정보를 없애기 위해 Cookie 헤더는 제거된다 (p155)
 
**프락시는 어디에 있는가**
1. 로컬 네트워크의 출구
2. ISP 입구 : 인터넷 대역폭 비용을 줄이기 위해 캐시 프락시를 앞에 둔다.
3. 웹 서버들의 바로 앞 : 대리 프락시. 웬만한 요청은 대리로 처리하고, 필요한 요청만 웹 서버에 넘긴다. 웹 서버와 IP 주소를 가장한다.
4. 네트워크 사이 : 트래픽 흐름을 감시하고 혼잡을 환화하기 위해 인터넷 피어링 교환 지점에 놓인다.


**프락시 계층**
- 연쇄적으로 연결된 프락시 계층에서 프락시들은 부모 자식 관계를 갖는다.
- 흐름이 꼭 정적인 것은 아니다. 요청의 상황에 맞게 동적으로 부모를 선택한다.(부하 균형, 지리적 인접성, 프로토콜/요청 타입, 유료 서비스 가입자 등에 따라)

**어떻게 프락시가 트래픽을 처리하는가**
- 프락시 설정이 자동으로 되어 있다면, 웹 클라이언트(브라우저)의 요청은 프락시를 타게 된다.
- 프락시 호스트와 포트를 직접 수동 설정할 수도 있다.
- 인터셉트 프락시는 클라이언트가 알지 못하는 상태에서 트래픽을 프락시로 보내는 스위칭, 라우팅 장치를 포함한다.
- 대리 프락시는 웹 서버의 이름과 IP 주소를 가장하므로, 대신 트래픽을 처리한다.
- 리다이렉션 코드를 반환함으로써 요청을 프락시로 리다이렉트할 수 있다.

### 6.5 프락시 요청의 미묘한 특징들
